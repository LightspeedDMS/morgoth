// P27_2708: task_done_internal inbox kind clears pane.current_task_id

rite main() {
    ≔ mut panes = [];
    push(panes, {id: "pane-0", current_task_id: "task-99", inbox: []});
    push(panes, {id: "pane-1", current_task_id: "task-42", inbox: []});
    push(panes, {id: "pane-2", current_task_id: null, inbox: []});

    // Simulate task_done_internal inbox handler for task-42
    ≔ imsg_payload = "task-42";
    ≔ mut tdi = 0;
    ⟳ tdi < len(panes) {
        ⎇ panes[tdi].current_task_id == imsg_payload {
            panes[tdi].current_task_id = null;
        }
        tdi = tdi + 1;
    }

    println(panes[0].current_task_id);        // task-99 (unchanged)
    println(panes[1].current_task_id == null); // true (cleared)
    println(panes[2].current_task_id == null); // true (was already null)
}
